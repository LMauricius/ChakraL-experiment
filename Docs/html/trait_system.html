
<!doctype html>
<html>
    <head>
        <title>trait system</title>
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="syntax_style.css">
    </head>

    <body>
        <div class="wrapper">
            <div class="sidebar">
                <div class="tableofcontents">
                    <p class="tableofcontents_title">Contents</p>
                            <li><a href="introduction.html">1&nbspIntroduction</a>
        <ul>
            <li><a href="how_to_read_the_documentation.html">1&nbspHow to read the documentation</a>
            </li>
            <li><a href="language_goals.html">2&nbspLanguage goals</a>
            </li>
            <li><a href="file_format.html">3&nbspFile format</a>
            </li>
            <li><a href="module_system.html">4&nbspModule system</a>
            </li>
        </ul>
        </li>
        <li>2&nbspBasic concepts
        <ul>
            <li><a href="context.html">1&nbspContext</a>
            </li>
            <li><a href="value.html">2&nbspValue</a>
            </li>
            <li><b>3 Trait system</b>
            </li>
        </ul>
        </li>
        <li>3&nbspLanguage features
        <ul>
            <li>1&nbspStatements
            <ul>
                <li><a href="using_statement.html">1&nbspusing statement</a>
                </li>
                <li><a href="if_statement.html">2&nbspif statement</a>
                </li>
            </ul>
            </li>
            <li><a href="expressions.html">2&nbspExpressions</a>
            <ul>
                <li><a href="module_expression.html">1&nbspmodule expression</a>
                </li>
            </ul>
            </li>
        </ul>
        </li>
        <li>4&nbspStandard library
        </li>

                </div>
            </div>
            <div class="main">
                <div class="pagecontent">
                    <h1 id="trait-system">Trait system</h1>
<h2 id="purpose">Purpose</h2>
<p>The trait system is useful in several ways. It allows the programmer to limit themself and prevent errors caused by improper use of data. It simultaneously tells the compiler how we are going to use the data, which allows it to optimize the machine code for that specific usage, causing the resulting program to run faster. As the trait system is quite <em>explicit</em> (without necessarily being <em>verbose</em>), this also allows other programmers who read our code to know what we intended to do with the data.</p>
<h2 id="satisfying-the-trait">Satisfying the trait</h2>
<p>If the context <code>c</code> satisfies the trait <code>t</code> we say that <code class="sourceCode chakral">c <span class="kw">is</span> t</code>. That satisfaction depends on <code>c</code> and <code>t</code>’s descriptions and specifiers. How the descriptions and specifiers are satisfied is described below.</p>
<h2 id="the-specifiers">The specifiers</h2>
<p>The specifiers change how the satisfaction is interpreted. They are useful to limit the contexts that satisfy the trait.</p>
<h3 id="final-specifier">final specifier</h3>
<div class="sourceCode" id="cb1" data-caption="Example of the difference between final and non-final traits"><pre class="sourceCode chakral"><code class="sourceCode chakral"><a class="sourceLine" id="cb1-1" title="1">Killable <span class="kw">def</span>:</a>
<a class="sourceLine" id="cb1-2" title="2">    health: Real <span class="op">=</span> <span class="fl">100.0</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="cf">ok</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">Dead <span class="kw">def</span>:</a>
<a class="sourceLine" id="cb1-6" title="6">    final health: Real <span class="op">=</span> <span class="fl">0.0</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="cf">ok</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9">p <span class="op">=</span> Killable</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="cf">with</span> output <span class="op">=</span> console:</a>
<a class="sourceLine" id="cb1-11" title="11">    write p <span class="co">**prints &#39;(health = 100.0)&#39;</span></a>
<a class="sourceLine" id="cb1-12" title="12">    write <span class="kw">whether</span> p <span class="kw">is</span> Killable <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb1-13" title="13">    write <span class="kw">whether</span> p <span class="kw">is</span> Dead <span class="co">**prints &#39;false&#39;</span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="cf">ok</span></a>
<a class="sourceLine" id="cb1-15" title="15"></a>
<a class="sourceLine" id="cb1-16" title="16">health p <span class="op">-=</span> <span class="fl">100.0</span></a>
<a class="sourceLine" id="cb1-17" title="17"><span class="cf">with</span> output <span class="op">=</span> console:</a>
<a class="sourceLine" id="cb1-18" title="18">    write p <span class="co">**prints &#39;(health = 0.0)&#39;</span></a>
<a class="sourceLine" id="cb1-19" title="19">    write <span class="kw">whether</span> p <span class="kw">is</span> Killable <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb1-20" title="20">    write <span class="kw">whether</span> p <span class="kw">is</span> Dead <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb1-21" title="21"><span class="cf">ok</span></a></code></pre></div>
<h3 id="explicit-specifier">explicit specifier</h3>
<p>If the trait <code>t</code> has an <code class="sourceCode chakral"><span class="kw">explicit</span></code> specifier, then it will only be satisfied if <code>c</code> was created as a copy of <code>t</code>. This requires the code that creates the context to epxlicitly want us to use <code>c</code> as <code>t</code>. If a value’s trait is manually specified to be <code>t</code>, and we try to assign it a context <code>c2</code> that is not <code>t</code>, <code>c2</code> will be <em>cast</em> (reinterpreted, if possible) to <code>t</code>.</p>
<div class="sourceCode" id="cb2" data-caption="Example of the difference between explicit and non-explicit traits"><pre class="sourceCode chakral"><code class="sourceCode chakral"><a class="sourceLine" id="cb2-1" title="1">Player <span class="kw">def</span>:</a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="kw">explicit</span></a>
<a class="sourceLine" id="cb2-3" title="3">    lives <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb2-4" title="4">    score <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="cf">ok</span></a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">PlayerLike <span class="kw">def</span>:</a>
<a class="sourceLine" id="cb2-8" title="8">    lives <span class="op">=</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb2-9" title="9">    score <span class="op">=</span> <span class="dv">0</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="cf">ok</span></a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12">p1 <span class="op">=</span> Player <span class="co">**copies the constant &#39;Player&#39; into a non-constant context</span></a>
<a class="sourceLine" id="cb2-13" title="13">p2 <span class="op">=</span> (lives <span class="op">=</span> <span class="dv">3</span>, score <span class="op">=</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-14" title="14">p3: Player <span class="op">=</span> (lives <span class="op">=</span> <span class="dv">3</span>, score <span class="op">=</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-15" title="15"></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="cf">with</span> output <span class="op">=</span> console:</a>
<a class="sourceLine" id="cb2-17" title="17">    write <span class="kw">whether</span> p1 <span class="kw">is</span> Player <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb2-18" title="18">    write <span class="kw">whether</span> p2 <span class="kw">is</span> Player <span class="co">**prints &#39;false&#39;</span></a>
<a class="sourceLine" id="cb2-19" title="19">    write <span class="kw">whether</span> p3 <span class="kw">is</span> Player <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb2-20" title="20">    write <span class="kw">whether</span> p1 <span class="kw">is</span> PlayerLike <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb2-21" title="21">    write <span class="kw">whether</span> p2 <span class="kw">is</span> PlayerLike <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb2-22" title="22">    write <span class="kw">whether</span> p3 <span class="kw">is</span> PlayerLike <span class="co">**prints &#39;true&#39;</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="cf">ok</span></a></code></pre></div>

                </div>
            </div>
        </div>
    </body>
</html>